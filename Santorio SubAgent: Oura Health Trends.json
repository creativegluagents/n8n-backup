{"createdAt":"2025-04-11T09:28:29.296Z","updatedAt":"2025-07-25T07:27:30.742Z","id":"umrlK3xVZsVvHKJr","name":"Santorio SubAgent: Oura Health Trends","active":false,"isArchived":false,"nodes":[{"parameters":{},"type":"n8n-nodes-base.executeWorkflowTrigger","typeVersion":1,"position":[-64,384],"id":"93651013-4050-4f73-8e58-3327ae3fb76f","name":"Execute Workflow Trigger"},{"parameters":{"promptType":"define","text":"={{ $('Execute Workflow Trigger').item.json.userQuery }}","options":{"systemMessage":"={{ ($json.content && $json.content.trim().length > 0) ? $json.content : `\n=You are the Aura Ring Health Query Trends Analyzer.\n### Your Task:\n\nBased on the user's input, detect intent and call the correct tool:\n\n* **Sleep-related terms** (e.g. *sleep, deep sleep, sleep efficiency, total sleep, sleep duration, sleep latency, sleep disturbances, restfulnes, efficiency, sleep score*) ‚Üí \\`oura_sleep_data_trends_tool\\`\n\n* **Readiness-related terms** (e.g. *readiness, HRV, recovery, energy, preparedness*) ‚Üí \\`oura_readiness_data_trends_tool\\`\n\n### Guidelines:\n\n* Extract and pass **start and end dates** if mentioned.\n* Always return a clear, trend-based summary:\n\n  * üìâ Declines (risks)\n  * üìà Improvements (opportunities)\n  * ‚ö†Ô∏è Key observations\n  * üí° Actionable tips\n* Optionally highlight **best/worst day** and give **personalized suggestions**.\n\n**Output must be simple, insightful, and user-friendly.**\nAdd each day trends in response with simple list formate  \nAlso Address: **Hey Kevin, here is your health trends.**\n\nOutout Should also include below (RIOs)\n1Ô∏è‚É£ **Risk:** Explain What Risk are involved in that.  \n2Ô∏è‚É£ **Insight:** Explain why this metric matters for recovery and performance.  \n3Ô∏è‚É£ **Opportunity:** Provide practical steps to improve sleep quality.  \n4Ô∏è‚É£ **Summary:** Keep it **concise, engaging, and user-specific**.  \n` }}","returnIntermediateSteps":true}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.7,"position":[512,384],"id":"a59311fa-591b-4776-9003-e4c83bc8d49f","name":"Health Metrics Query Agent1"},{"parameters":{"content":"# Main Agent ","height":240,"width":500,"color":5},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[368,320],"id":"10182377-1ebd-4839-8879-b907284aea2b","name":"Sticky Note3"},{"parameters":{"content":"## Agent Trigger\n","height":240,"color":3},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-128,304],"id":"aed6328a-eefb-4c77-96b0-80db63bf7e17","name":"Sticky Note"},{"parameters":{"content":"# Oura Ring Tools","height":240,"width":1060,"color":6},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[368,592],"id":"2c187a37-7aef-4741-8f21-e8d737d25930","name":"Sticky Note2"},{"parameters":{"content":"# Brain","height":240,"color":6},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[112,592],"id":"fb3c43db-290e-46e4-8874-3b4936254207","name":"Sticky Note1"},{"parameters":{"chatId":"={{ $('Execute Workflow Trigger').item.json.chatID }}","text":"={{ $json.output }}","additionalFields":{"appendAttribution":false}},"type":"n8n-nodes-base.telegram","typeVersion":1.2,"position":[1232,384],"id":"ad514846-d26a-4339-9d08-4b7e58975a1b","name":"Send a text message","webhookId":"83aaf73e-1fb9-4485-abd6-a76bda36e51f","credentials":{"telegramApi":{"id":"n9uqHVVmsUH0LY6C","name":"Santorio-API-Token"}}},{"parameters":{"content":"## Response\n","height":240,"width":540,"color":4},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[880,320],"id":"fdd0b7f2-a4f8-4e4f-a69a-603cad34c808","name":"Sticky Note4"},{"parameters":{"model":"gpt-4.1","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1,"position":[192,688],"id":"2fc10bdb-267a-4b19-91b4-b57e1bef7cef","name":"Chat Modal","credentials":{"openAiApi":{"id":"hpvxzuW3W9YmuUCO","name":"OpenAi account"}}},{"parameters":{"operation":"getActivity","limit":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Limit', `Take a limit based on start  date and end date`, 'number') }}","filters":{"end":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('End_Date', ``, 'string') }}","start":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Start_Date', ``, 'string') }}"}},"type":"n8n-nodes-base.ouraTool","typeVersion":1,"position":[480,688],"id":"24ae8a73-e658-4d3c-8c13-0639b3c2b68a","name":"OuraActivityData","credentials":{"ouraApi":{"id":"5O0gsZUPpdyCfRsF","name":"Oura account"}}},{"parameters":{"descriptionType":"manual","toolDescription":"Call the oura_rediness_data_trends_tool to fetch and analyze readiness data trends, including recovery, energy levels, and preparedness, providing insights into the body‚Äôs recovery and readiness.","operation":"getReadiness","limit":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Limit', `Take a limit based on start  date and end date`, 'number') }}","filters":{"end":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('End_Date', ``, 'string') }}","start":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Start_Date', ``, 'string') }}"}},"type":"n8n-nodes-base.ouraTool","typeVersion":1,"position":[880,688],"id":"d5c21b8f-88a2-408f-8963-4d4fd46d0c16","name":"OuraRedinessData","credentials":{"ouraApi":{"id":"5O0gsZUPpdyCfRsF","name":"Oura account"}}},{"parameters":{"descriptionType":"manual","toolDescription":"Call the oura_sleep_data_trends_tool to fetch and analyze sleep data trends, including metrics like sleep score, deep sleep, efficiency, and REM sleep, over a specific period.","limit":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Limit', `Take a limit based on start  date and end date`, 'number') }}","filters":{"end":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('End_Date', ``, 'string') }}","start":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Start_Date', ``, 'string') }}"}},"type":"n8n-nodes-base.ouraTool","typeVersion":1,"position":[1232,688],"id":"ea11bbbb-2b14-4fe0-9444-1367cdf69bd0","name":"OuraSleepData","credentials":{"ouraApi":{"id":"5O0gsZUPpdyCfRsF","name":"Oura account"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"e6066e3f-e834-4bb9-95cf-9a7b0525393d","leftValue":"={{ $('Execute Workflow Trigger').item.json.chatID }}","rightValue":"cg_admin","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[960,384],"id":"73529c89-4e0a-4aea-b357-e7c8d0ff25d2","name":"If"},{"parameters":{"operation":"get","documentURL":"1n-4S1zxl_i_6YKf0LaysTL7gw-QyD6HTot3N1o0xpew"},"type":"n8n-nodes-base.googleDocs","typeVersion":2,"position":[208,384],"id":"c80725ff-73a1-4cf7-bc21-229ae15ed1b1","name":"Get a document","credentials":{"googleDocsOAuth2Api":{"id":"T0uBlmGwFoQcaNzt","name":"Gluagents Google Docs"}}}],"connections":{"Execute Workflow Trigger":{"main":[[{"node":"Get a document","type":"main","index":0}]]},"Health Metrics Query Agent1":{"main":[[{"node":"If","type":"main","index":0}]]},"Chat Modal":{"ai_languageModel":[[{"node":"Health Metrics Query Agent1","type":"ai_languageModel","index":0}]]},"OuraActivityData":{"ai_tool":[[{"node":"Health Metrics Query Agent1","type":"ai_tool","index":0}]]},"OuraRedinessData":{"ai_tool":[[{"node":"Health Metrics Query Agent1","type":"ai_tool","index":0}]]},"OuraSleepData":{"ai_tool":[[{"node":"Health Metrics Query Agent1","type":"ai_tool","index":0}]]},"If":{"main":[[],[{"node":"Send a text message","type":"main","index":0}]]},"Get a document":{"main":[[{"node":"Health Metrics Query Agent1","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"5fc575a4-474d-4d7c-a92e-224ab66faaf7","triggerCount":0,"tags":[{"createdAt":"2025-04-11T09:22:08.440Z","updatedAt":"2025-04-11T09:22:08.440Z","id":"cvzQAF8NRsTc2q4S","name":"Santorio"},{"createdAt":"2025-04-11T09:23:59.152Z","updatedAt":"2025-04-11T09:23:59.152Z","id":"fSbMm0PHqiXhIK0L","name":"SAN-3.0 subworkflow"},{"createdAt":"2025-04-11T09:28:50.842Z","updatedAt":"2025-04-11T09:28:50.842Z","id":"zs2sreDkbL3PMpx4","name":"San 3.0 - Sub"}]}