{"createdAt":"2025-08-01T09:36:45.231Z","updatedAt":"2025-08-01T12:11:26.419Z","id":"tqrgduXe2fkW7UrJ","name":"Danger Detector","active":false,"isArchived":false,"nodes":[{"parameters":{"model":{"__rl":true,"value":"gpt-4.1","mode":"list","cachedResultName":"gpt-4.1"},"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[624,224],"id":"1515baf3-c3b0-4760-bdc5-96b8f793b385","name":"OpenAI Chat Model1","credentials":{"openAiApi":{"id":"G5B8fc5uUqqLH94p","name":"OpenAi account 3"}}},{"parameters":{"promptType":"define","text":"=List: {{ $json.toJsonString() }}\nReport: {{ $json.report }}","options":{"systemMessage":"=You are an environmental danger detector for NSW, Australia.\n\nYour Task:\nUse the domain name and volume as anchors.\nThen, scan the entire waste report‚Äîincluding the narrative, material descriptions, lab results, and appendices‚Äîfor hazards listed below.\nOnly flag a danger if you find the hazard for that specific domain/stockpile/area in the report.\nFlag each detected hazard using the EPA‚Äôs official danger triggers and thresholds. If multiple hazards are found, flag each one.\nIf none are found, state ‚ÄúNo hazardous substances detected.‚Äù\nDo NOT assign an EPA waste class‚Äîjust flag hazards.\n\nNSW EPA Danger Triggers & Thresholds (Strictly Apply):\nSpecial Waste Triggers (EPA Step 1, p. 4‚Äì5):\nAsbestos: Any detection in description or lab =\nüö® DANGER: Asbestos detected\n\nClinical/related waste: Any detection (medical, pharmaceutical, cytotoxic, sharps, blood-stained) =\nüö® DANGER: Clinical/related waste detected\n\nWaste tyres: Any detection (whole, shredded, fragments) =\nüö® DANGER: Waste tyres detected\n\nPFAS and Forever Chemicals:\nPFAS/PFOA/PFOS:\n\n4 mg/kg in soil =\nüö® DANGER: PFAS detected at [value] mg/kg (limit: 4 mg/kg)\n‚â§ 4 mg/kg =\n‚ö†Ô∏è WARNING: PFAS detected below danger threshold ([value] mg/kg)\n\nPASS / Acid Sulphate Soils:\nAny presence of ‚ÄúPASS‚Äù, ‚ÄúPotential Acid Sulphate Soil‚Äù, or ‚ÄúAcid Sulphate Soil‚Äù =\n‚ö†Ô∏è WARNING: Acid Sulphate Soil (PASS) detected ‚Äî special management required\n\nDangerous Goods:\nIf flagged as a dangerous good (Class 1, 2, 4.1, 4.2, 4.3, 5, 6.1, 8 in the Transport of Dangerous Goods Code) =\nüö® DANGER: Dangerous Good detected (class [class])\n\nEPA Key Chemicals & Danger Thresholds (Table 1, p. 12‚Äì16):\nFlag as DANGER if lab result for any is above:\n\nChemical\tDanger Threshold (mg/kg)\nLead\t400\nMercury\t16\nPCBs (Polychlorinated Biphenyls)\t50\nTotal PAHs (sum of 16 PAHs)\t800\n\nEPA Scheduled Chemicals ‚Äì Danger Thresholds (ALL = 50 mg/kg)\n(From Table 1, p. 15‚Äì16 of NSW EPA classify-waste.pdf)\n\nAldrin\n\nalpha-BHC (Hexachlorocyclohexane)\n\nbeta-BHC\n\ngamma-BHC (Lindane)\n\ndelta-BHC\n\nChlordane\n\nDDT (total)\n\nDieldrin\n\nEndosulfan (alpha-, beta-, total, sulfate)\n\nEndrin\n\nHeptachlor\n\nHeptachlor epoxide\n\nHexachlorobenzene\n\nMirex\n\nPentachlorophenol\n\nToxaphene\n\nFor any of the above:\n\n50 mg/kg or more =\nüö® DANGER: [Chemical name] detected at [value] mg/kg (limit: 50 mg/kg)\n\nOutput Format (JSON array, one object per domain):\nFor each domain object you receive as input, append a new field called danger_flags containing the list of all detected hazard/warning flags (as described below).\nDo not remove or replace any existing fields from the input object.\nReturn the entire updated list of domain objects, each now including the appended danger_flags array.\n[\n  {\n    \"name\": \"Stockpile 7 (SP-7)\",\n    \"danger_flags\": [\"‚úÖ No hazardous substances detected\"]\n  },\n  {\n    \"name\": \"Vegetation Stockpile DSP03\",\n    \"danger_flags\": [\"üö® DANGER: Asbestos detected\"]\n  },\n  {\n    \"name\": \"SP6 (Hydro, nightworks)\",\n    \"danger_flags\": [\n      \"‚ö†Ô∏è WARNING: PFAS detected below danger threshold (3.2 mg/kg)\",\n      \"üö® DANGER: Lead detected at 450 mg/kg (limit: 400 mg/kg)\"\n    ]\n  }\n]\nList every detected flag per domain.\n\nIf no hazard, just output: ‚úÖ No hazardous substances detected\n\nNo commentary, no summary‚Äîjust the JSON array.\n\nInstructions:\nFor each domain from Agent 3, strictly scan the waste report (narrative and laboratory data) for the danger triggers and chemical names/thresholds above.\n\nIf any result for a scheduled chemical (list above) is ‚â• 50 mg/kg, flag as DANGER.\n\nIf multiple hazards, flag all.\n\nDo not assign regulatory class‚Äîjust flags.\n\nIf a value or chemical is not present, ignore.\n\nIf threshold is missing, flag as: WARNING: [Chemical name] detected, no threshold available.\n\n"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.1,"position":[528,0],"id":"4c949795-193a-424d-b134-89a86df02415","name":"AI Agent1"},{"parameters":{"workflowInputs":{"values":[{"name":"list","type":"any"},{"name":"report","type":"any"}]}},"id":"4cbcd1fc-1bb7-462d-8dad-22ce1cc2ac16","typeVersion":1.1,"name":"Start","type":"n8n-nodes-base.executeWorkflowTrigger","position":[304,0]},{"parameters":{"promptType":"define","text":"={{ $json.output }}","options":{"systemMessage":"You are a helpful assistant\nYou will receive an output make a professional user message on the base of it.\nLike this are the domains we got from report and their other details."}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.1,"position":[928,0],"id":"96b74559-c1d2-4976-bec2-20f4927e289f","name":"AI Agent"},{"parameters":{"model":{"__rl":true,"value":"gpt-4.1","mode":"list","cachedResultName":"gpt-4.1"},"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[1024,224],"id":"05fc55c5-eb32-4c94-a15e-0855ddc9fb7f","name":"OpenAI Chat Model","credentials":{"openAiApi":{"id":"G5B8fc5uUqqLH94p","name":"OpenAi account 3"}}}],"connections":{"OpenAI Chat Model1":{"ai_languageModel":[[{"node":"AI Agent1","type":"ai_languageModel","index":0}]]},"AI Agent1":{"main":[[{"node":"AI Agent","type":"main","index":0}]]},"Start":{"main":[[{"node":"AI Agent1","type":"main","index":0}]]},"OpenAI Chat Model":{"ai_languageModel":[[{"node":"AI Agent","type":"ai_languageModel","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"1d8534f7-e660-491b-8a73-61bc3f9cf05e","triggerCount":0,"tags":[]}